<!DOCTYPE html>

<html>
<head>
	<title>text.js</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<link rel="stylesheet" media="all" href="../docco.css" />
	<style type="text/css">
		
	</style>
</head>
<body>

	<div id="jump_to">
		<a class="large" href="javascript:void(0);">Other source files&hellip;</a>
		<div id="jump_contents">
			
				<input type="search" id="jump_search" placeholder="search for source file">
			
			<ul id="jump_list">
				
					
					<li data-source="src/abs.js" class="list_source">
						<a class="source" href="abs.html">src/abs.js</a>
					</li>
				
					
					<li data-source="src/accrint.js" class="list_source">
						<a class="source" href="accrint.html">src/accrint.js</a>
					</li>
				
					
					<li data-source="src/acos.js" class="list_source">
						<a class="source" href="acos.html">src/acos.js</a>
					</li>
				
					
					<li data-source="src/acosh.js" class="list_source">
						<a class="source" href="acosh.html">src/acosh.js</a>
					</li>
				
					
					<li data-source="src/acot.js" class="list_source">
						<a class="source" href="acot.html">src/acot.js</a>
					</li>
				
					
					<li data-source="src/acoth.js" class="list_source">
						<a class="source" href="acoth.html">src/acoth.js</a>
					</li>
				
					
					<li data-source="src/add.js" class="list_source">
						<a class="source" href="add.html">src/add.js</a>
					</li>
				
					
					<li data-source="src/address.js" class="list_source">
						<a class="source" href="address.html">src/address.js</a>
					</li>
				
					
					<li data-source="src/and.js" class="list_source">
						<a class="source" href="and.html">src/and.js</a>
					</li>
				
					
					<li data-source="src/asin.js" class="list_source">
						<a class="source" href="asin.html">src/asin.js</a>
					</li>
				
					
					<li data-source="src/asinh.js" class="list_source">
						<a class="source" href="asinh.html">src/asinh.js</a>
					</li>
				
					
					<li data-source="src/assign.js" class="list_source">
						<a class="source" href="assign.html">src/assign.js</a>
					</li>
				
					
					<li data-source="src/atan.js" class="list_source">
						<a class="source" href="atan.html">src/atan.js</a>
					</li>
				
					
					<li data-source="src/atan2.js" class="list_source">
						<a class="source" href="atan2.html">src/atan2.js</a>
					</li>
				
					
					<li data-source="src/atanh.js" class="list_source">
						<a class="source" href="atanh.html">src/atanh.js</a>
					</li>
				
					
					<li data-source="src/average.js" class="list_source">
						<a class="source" href="average.html">src/average.js</a>
					</li>
				
					
					<li data-source="src/base.js" class="list_source">
						<a class="source" href="base.html">src/base.js</a>
					</li>
				
					
					<li data-source="src/bin2dec.js" class="list_source">
						<a class="source" href="bin2dec.html">src/bin2dec.js</a>
					</li>
				
					
					<li data-source="src/branch.js" class="list_source">
						<a class="source" href="branch.html">src/branch.js</a>
					</li>
				
					
					<li data-source="src/camelcase.js" class="list_source">
						<a class="source" href="camelcase.html">src/camelcase.js</a>
					</li>
				
					
					<li data-source="src/ceiling.js" class="list_source">
						<a class="source" href="ceiling.html">src/ceiling.js</a>
					</li>
				
					
					<li data-source="src/cellindex.js" class="list_source">
						<a class="source" href="cellindex.html">src/cellindex.js</a>
					</li>
				
					
					<li data-source="src/changed.js" class="list_source">
						<a class="source" href="changed.html">src/changed.js</a>
					</li>
				
					
					<li data-source="src/char.js" class="list_source">
						<a class="source" href="char.html">src/char.js</a>
					</li>
				
					
					<li data-source="src/choose.js" class="list_source">
						<a class="source" href="choose.html">src/choose.js</a>
					</li>
				
					
					<li data-source="src/clean.js" class="list_source">
						<a class="source" href="clean.html">src/clean.js</a>
					</li>
				
					
					<li data-source="src/code.js" class="list_source">
						<a class="source" href="code.html">src/code.js</a>
					</li>
				
					
					<li data-source="src/column.js" class="list_source">
						<a class="source" href="column.html">src/column.js</a>
					</li>
				
					
					<li data-source="src/columnletter.js" class="list_source">
						<a class="source" href="columnletter.html">src/columnletter.js</a>
					</li>
				
					
					<li data-source="src/columnnumber.js" class="list_source">
						<a class="source" href="columnnumber.html">src/columnnumber.js</a>
					</li>
				
					
					<li data-source="src/compile.js" class="list_source">
						<a class="source" href="compile.html">src/compile.js</a>
					</li>
				
					
					<li data-source="src/concatenate.js" class="list_source">
						<a class="source" href="concatenate.html">src/concatenate.js</a>
					</li>
				
					
					<li data-source="src/constants.js" class="list_source">
						<a class="source" href="constants.html">src/constants.js</a>
					</li>
				
					
					<li data-source="src/cos.js" class="list_source">
						<a class="source" href="cos.html">src/cos.js</a>
					</li>
				
					
					<li data-source="src/cumipmt.js" class="list_source">
						<a class="source" href="cumipmt.html">src/cumipmt.js</a>
					</li>
				
					
					<li data-source="src/date.js" class="list_source">
						<a class="source" href="date.html">src/date.js</a>
					</li>
				
					
					<li data-source="src/datedif.js" class="list_source">
						<a class="source" href="datedif.html">src/datedif.js</a>
					</li>
				
					
					<li data-source="src/datevalue.js" class="list_source">
						<a class="source" href="datevalue.html">src/datevalue.js</a>
					</li>
				
					
					<li data-source="src/day.js" class="list_source">
						<a class="source" href="day.html">src/day.js</a>
					</li>
				
					
					<li data-source="src/days360.js" class="list_source">
						<a class="source" href="days360.html">src/days360.js</a>
					</li>
				
					
					<li data-source="src/dec2bin.js" class="list_source">
						<a class="source" href="dec2bin.html">src/dec2bin.js</a>
					</li>
				
					
					<li data-source="src/decodebase64.js" class="list_source">
						<a class="source" href="decodebase64.html">src/decodebase64.js</a>
					</li>
				
					
					<li data-source="src/decodejwt.js" class="list_source">
						<a class="source" href="decodejwt.html">src/decodejwt.js</a>
					</li>
				
					
					<li data-source="src/degrees.js" class="list_source">
						<a class="source" href="degrees.html">src/degrees.js</a>
					</li>
				
					
					<li data-source="src/diff.js" class="list_source">
						<a class="source" href="diff.html">src/diff.js</a>
					</li>
				
					
					<li data-source="src/divide.js" class="list_source">
						<a class="source" href="divide.html">src/divide.js</a>
					</li>
				
					
					<li data-source="src/edate.js" class="list_source">
						<a class="source" href="edate.html">src/edate.js</a>
					</li>
				
					
					<li data-source="src/entries.js" class="list_source">
						<a class="source" href="entries.html">src/entries.js</a>
					</li>
				
					
					<li data-source="src/eomonth.js" class="list_source">
						<a class="source" href="eomonth.html">src/eomonth.js</a>
					</li>
				
					
					<li data-source="src/eq.js" class="list_source">
						<a class="source" href="eq.html">src/eq.js</a>
					</li>
				
					
					<li data-source="src/error.js" class="list_source">
						<a class="source" href="error.html">src/error.js</a>
					</li>
				
					
					<li data-source="src/even.js" class="list_source">
						<a class="source" href="even.html">src/even.js</a>
					</li>
				
					
					<li data-source="src/exact.js" class="list_source">
						<a class="source" href="exact.html">src/exact.js</a>
					</li>
				
					
					<li data-source="src/filter.js" class="list_source">
						<a class="source" href="filter.html">src/filter.js</a>
					</li>
				
					
					<li data-source="src/find.js" class="list_source">
						<a class="source" href="find.html">src/find.js</a>
					</li>
				
					
					<li data-source="src/flatten.js" class="list_source">
						<a class="source" href="flatten.html">src/flatten.js</a>
					</li>
				
					
					<li data-source="src/floor.js" class="list_source">
						<a class="source" href="floor.html">src/floor.js</a>
					</li>
				
					
					<li data-source="src/functions.js" class="list_source">
						<a class="source" href="functions.html">src/functions.js</a>
					</li>
				
					
					<li data-source="src/fv.js" class="list_source">
						<a class="source" href="fv.html">src/fv.js</a>
					</li>
				
					
					<li data-source="src/get.js" class="list_source">
						<a class="source" href="get.html">src/get.js</a>
					</li>
				
					
					<li data-source="src/group.js" class="list_source">
						<a class="source" href="group.html">src/group.js</a>
					</li>
				
					
					<li data-source="src/gt.js" class="list_source">
						<a class="source" href="gt.html">src/gt.js</a>
					</li>
				
					
					<li data-source="src/gte.js" class="list_source">
						<a class="source" href="gte.html">src/gte.js</a>
					</li>
				
					
					<li data-source="src/guid.js" class="list_source">
						<a class="source" href="guid.html">src/guid.js</a>
					</li>
				
					
					<li data-source="src/hash.js" class="list_source">
						<a class="source" href="hash.html">src/hash.js</a>
					</li>
				
					
					<li data-source="src/hlookup.js" class="list_source">
						<a class="source" href="hlookup.html">src/hlookup.js</a>
					</li>
				
					
					<li data-source="src/hour.js" class="list_source">
						<a class="source" href="hour.html">src/hour.js</a>
					</li>
				
					
					<li data-source="src/identity.js" class="list_source">
						<a class="source" href="identity.html">src/identity.js</a>
					</li>
				
					
					<li data-source="src/ifblank.js" class="list_source">
						<a class="source" href="ifblank.html">src/ifblank.js</a>
					</li>
				
					
					<li data-source="src/ifempty.js" class="list_source">
						<a class="source" href="ifempty.html">src/ifempty.js</a>
					</li>
				
					
					<li data-source="src/iferror.js" class="list_source">
						<a class="source" href="iferror.html">src/iferror.js</a>
					</li>
				
					
					<li data-source="src/ifna.js" class="list_source">
						<a class="source" href="ifna.html">src/ifna.js</a>
					</li>
				
					
					<li data-source="src/includes.js" class="list_source">
						<a class="source" href="includes.html">src/includes.js</a>
					</li>
				
					
					<li data-source="src/index.js" class="list_source">
						<a class="source" href="index.html">src/index.js</a>
					</li>
				
					
					<li data-source="src/index2col.js" class="list_source">
						<a class="source" href="index2col.html">src/index2col.js</a>
					</li>
				
					
					<li data-source="src/index2row.js" class="list_source">
						<a class="source" href="index2row.html">src/index2row.js</a>
					</li>
				
					
					<li data-source="src/int.js" class="list_source">
						<a class="source" href="int.html">src/int.js</a>
					</li>
				
					
					<li data-source="src/interpolate.js" class="list_source">
						<a class="source" href="interpolate.html">src/interpolate.js</a>
					</li>
				
					
					<li data-source="src/interpolator.js" class="list_source">
						<a class="source" href="interpolator.html">src/interpolator.js</a>
					</li>
				
					
					<li data-source="src/intersect.js" class="list_source">
						<a class="source" href="intersect.html">src/intersect.js</a>
					</li>
				
					
					<li data-source="src/ipmt.js" class="list_source">
						<a class="source" href="ipmt.html">src/ipmt.js</a>
					</li>
				
					
					<li data-source="src/isarray.js" class="list_source">
						<a class="source" href="isarray.html">src/isarray.js</a>
					</li>
				
					
					<li data-source="src/isasyncfunction.js" class="list_source">
						<a class="source" href="isasyncfunction.html">src/isasyncfunction.js</a>
					</li>
				
					
					<li data-source="src/isbinary.js" class="list_source">
						<a class="source" href="isbinary.html">src/isbinary.js</a>
					</li>
				
					
					<li data-source="src/isblank.js" class="list_source">
						<a class="source" href="isblank.html">src/isblank.js</a>
					</li>
				
					
					<li data-source="src/isboolean.js" class="list_source">
						<a class="source" href="isboolean.html">src/isboolean.js</a>
					</li>
				
					
					<li data-source="src/isdate.js" class="list_source">
						<a class="source" href="isdate.html">src/isdate.js</a>
					</li>
				
					
					<li data-source="src/isemail.js" class="list_source">
						<a class="source" href="isemail.html">src/isemail.js</a>
					</li>
				
					
					<li data-source="src/isempty.js" class="list_source">
						<a class="source" href="isempty.html">src/isempty.js</a>
					</li>
				
					
					<li data-source="src/iserr.js" class="list_source">
						<a class="source" href="iserr.html">src/iserr.js</a>
					</li>
				
					
					<li data-source="src/iserror.js" class="list_source">
						<a class="source" href="iserror.html">src/iserror.js</a>
					</li>
				
					
					<li data-source="src/iseven.js" class="list_source">
						<a class="source" href="iseven.html">src/iseven.js</a>
					</li>
				
					
					<li data-source="src/isfalsy.js" class="list_source">
						<a class="source" href="isfalsy.html">src/isfalsy.js</a>
					</li>
				
					
					<li data-source="src/isfunction.js" class="list_source">
						<a class="source" href="isfunction.html">src/isfunction.js</a>
					</li>
				
					
					<li data-source="src/isleapyear.js" class="list_source">
						<a class="source" href="isleapyear.html">src/isleapyear.js</a>
					</li>
				
					
					<li data-source="src/islowercase.js" class="list_source">
						<a class="source" href="islowercase.html">src/islowercase.js</a>
					</li>
				
					
					<li data-source="src/isna.js" class="list_source">
						<a class="source" href="isna.html">src/isna.js</a>
					</li>
				
					
					<li data-source="src/isnan.js" class="list_source">
						<a class="source" href="isnan.html">src/isnan.js</a>
					</li>
				
					
					<li data-source="src/isnumber.js" class="list_source">
						<a class="source" href="isnumber.html">src/isnumber.js</a>
					</li>
				
					
					<li data-source="src/isobject.js" class="list_source">
						<a class="source" href="isobject.html">src/isobject.js</a>
					</li>
				
					
					<li data-source="src/isodd.js" class="list_source">
						<a class="source" href="isodd.html">src/isodd.js</a>
					</li>
				
					
					<li data-source="src/isoweeknum.js" class="list_source">
						<a class="source" href="isoweeknum.html">src/isoweeknum.js</a>
					</li>
				
					
					<li data-source="src/ispromise.js" class="list_source">
						<a class="source" href="ispromise.html">src/ispromise.js</a>
					</li>
				
					
					<li data-source="src/isref.js" class="list_source">
						<a class="source" href="isref.html">src/isref.js</a>
					</li>
				
					
					<li data-source="src/istext.js" class="list_source">
						<a class="source" href="istext.html">src/istext.js</a>
					</li>
				
					
					<li data-source="src/istruthy.js" class="list_source">
						<a class="source" href="istruthy.html">src/istruthy.js</a>
					</li>
				
					
					<li data-source="src/isuppercase.js" class="list_source">
						<a class="source" href="isuppercase.html">src/isuppercase.js</a>
					</li>
				
					
					<li data-source="src/isurl.js" class="list_source">
						<a class="source" href="isurl.html">src/isurl.js</a>
					</li>
				
					
					<li data-source="src/iswholenumber.js" class="list_source">
						<a class="source" href="iswholenumber.html">src/iswholenumber.js</a>
					</li>
				
					
					<li data-source="src/join.js" class="list_source">
						<a class="source" href="join.html">src/join.js</a>
					</li>
				
					
					<li data-source="src/keys.js" class="list_source">
						<a class="source" href="keys.html">src/keys.js</a>
					</li>
				
					
					<li data-source="src/left.js" class="list_source">
						<a class="source" href="left.html">src/left.js</a>
					</li>
				
					
					<li data-source="src/len.js" class="list_source">
						<a class="source" href="len.html">src/len.js</a>
					</li>
				
					
					<li data-source="src/lookup.js" class="list_source">
						<a class="source" href="lookup.html">src/lookup.js</a>
					</li>
				
					
					<li data-source="src/lower.js" class="list_source">
						<a class="source" href="lower.html">src/lower.js</a>
					</li>
				
					
					<li data-source="src/lt.js" class="list_source">
						<a class="source" href="lt.html">src/lt.js</a>
					</li>
				
					
					<li data-source="src/lte.js" class="list_source">
						<a class="source" href="lte.html">src/lte.js</a>
					</li>
				
					
					<li data-source="src/map.js" class="list_source">
						<a class="source" href="map.html">src/map.js</a>
					</li>
				
					
					<li data-source="src/match.js" class="list_source">
						<a class="source" href="match.html">src/match.js</a>
					</li>
				
					
					<li data-source="src/max.js" class="list_source">
						<a class="source" href="max.html">src/max.js</a>
					</li>
				
					
					<li data-source="src/merge.js" class="list_source">
						<a class="source" href="merge.html">src/merge.js</a>
					</li>
				
					
					<li data-source="src/min.js" class="list_source">
						<a class="source" href="min.html">src/min.js</a>
					</li>
				
					
					<li data-source="src/minus.js" class="list_source">
						<a class="source" href="minus.html">src/minus.js</a>
					</li>
				
					
					<li data-source="src/minute.js" class="list_source">
						<a class="source" href="minute.html">src/minute.js</a>
					</li>
				
					
					<li data-source="src/mod.js" class="list_source">
						<a class="source" href="mod.html">src/mod.js</a>
					</li>
				
					
					<li data-source="src/month.js" class="list_source">
						<a class="source" href="month.html">src/month.js</a>
					</li>
				
					
					<li data-source="src/multiply.js" class="list_source">
						<a class="source" href="multiply.html">src/multiply.js</a>
					</li>
				
					
					<li data-source="src/n.js" class="list_source">
						<a class="source" href="n.html">src/n.js</a>
					</li>
				
					
					<li data-source="src/nand.js" class="list_source">
						<a class="source" href="nand.html">src/nand.js</a>
					</li>
				
					
					<li data-source="src/ne.js" class="list_source">
						<a class="source" href="ne.html">src/ne.js</a>
					</li>
				
					
					<li data-source="src/nor.js" class="list_source">
						<a class="source" href="nor.html">src/nor.js</a>
					</li>
				
					
					<li data-source="src/not.js" class="list_source">
						<a class="source" href="not.html">src/not.js</a>
					</li>
				
					
					<li data-source="src/notincludes.js" class="list_source">
						<a class="source" href="notincludes.html">src/notincludes.js</a>
					</li>
				
					
					<li data-source="src/now.js" class="list_source">
						<a class="source" href="now.html">src/now.js</a>
					</li>
				
					
					<li data-source="src/nper.js" class="list_source">
						<a class="source" href="nper.html">src/nper.js</a>
					</li>
				
					
					<li data-source="src/npv.js" class="list_source">
						<a class="source" href="npv.html">src/npv.js</a>
					</li>
				
					
					<li data-source="src/numbers.js" class="list_source">
						<a class="source" href="numbers.html">src/numbers.js</a>
					</li>
				
					
					<li data-source="src/numbervalue.js" class="list_source">
						<a class="source" href="numbervalue.html">src/numbervalue.js</a>
					</li>
				
					
					<li data-source="src/oct2dec.js" class="list_source">
						<a class="source" href="oct2dec.html">src/oct2dec.js</a>
					</li>
				
					
					<li data-source="src/or.js" class="list_source">
						<a class="source" href="or.html">src/or.js</a>
					</li>
				
					
					<li data-source="src/overlap.js" class="list_source">
						<a class="source" href="overlap.html">src/overlap.js</a>
					</li>
				
					
					<li data-source="src/parsebool.js" class="list_source">
						<a class="source" href="parsebool.html">src/parsebool.js</a>
					</li>
				
					
					<li data-source="src/parsedate.js" class="list_source">
						<a class="source" href="parsedate.html">src/parsedate.js</a>
					</li>
				
					
					<li data-source="src/parsequery.js" class="list_source">
						<a class="source" href="parsequery.html">src/parsequery.js</a>
					</li>
				
					
					<li data-source="src/parser.js" class="list_source">
						<a class="source" href="parser.html">src/parser.js</a>
					</li>
				
					
					<li data-source="src/pi.js" class="list_source">
						<a class="source" href="pi.html">src/pi.js</a>
					</li>
				
					
					<li data-source="src/pluck.js" class="list_source">
						<a class="source" href="pluck.html">src/pluck.js</a>
					</li>
				
					
					<li data-source="src/plus.js" class="list_source">
						<a class="source" href="plus.html">src/plus.js</a>
					</li>
				
					
					<li data-source="src/pmt.js" class="list_source">
						<a class="source" href="pmt.html">src/pmt.js</a>
					</li>
				
					
					<li data-source="src/power.js" class="list_source">
						<a class="source" href="power.html">src/power.js</a>
					</li>
				
					
					<li data-source="src/proper.js" class="list_source">
						<a class="source" href="proper.html">src/proper.js</a>
					</li>
				
					
					<li data-source="src/pv.js" class="list_source">
						<a class="source" href="pv.html">src/pv.js</a>
					</li>
				
					
					<li data-source="src/query.js" class="list_source">
						<a class="source" href="query.html">src/query.js</a>
					</li>
				
					
					<li data-source="src/reduce.js" class="list_source">
						<a class="source" href="reduce.html">src/reduce.js</a>
					</li>
				
					
					<li data-source="src/ref.js" class="list_source">
						<a class="source" href="ref.html">src/ref.js</a>
					</li>
				
					
					<li data-source="src/replace.js" class="list_source">
						<a class="source" href="replace.html">src/replace.js</a>
					</li>
				
					
					<li data-source="src/rept.js" class="list_source">
						<a class="source" href="rept.html">src/rept.js</a>
					</li>
				
					
					<li data-source="src/right.js" class="list_source">
						<a class="source" href="right.html">src/right.js</a>
					</li>
				
					
					<li data-source="src/round.js" class="list_source">
						<a class="source" href="round.html">src/round.js</a>
					</li>
				
					
					<li data-source="src/roundup.js" class="list_source">
						<a class="source" href="roundup.html">src/roundup.js</a>
					</li>
				
					
					<li data-source="src/run.js" class="list_source">
						<a class="source" href="run.html">src/run.js</a>
					</li>
				
					
					<li data-source="src/search.js" class="list_source">
						<a class="source" href="search.html">src/search.js</a>
					</li>
				
					
					<li data-source="src/second.js" class="list_source">
						<a class="source" href="second.html">src/second.js</a>
					</li>
				
					
					<li data-source="src/select.js" class="list_source">
						<a class="source" href="select.html">src/select.js</a>
					</li>
				
					
					<li data-source="src/serial.js" class="list_source">
						<a class="source" href="serial.html">src/serial.js</a>
					</li>
				
					
					<li data-source="src/sin.js" class="list_source">
						<a class="source" href="sin.html">src/sin.js</a>
					</li>
				
					
					<li data-source="src/snakecase.js" class="list_source">
						<a class="source" href="snakecase.html">src/snakecase.js</a>
					</li>
				
					
					<li data-source="src/some.js" class="list_source">
						<a class="source" href="some.html">src/some.js</a>
					</li>
				
					
					<li data-source="src/sort.js" class="list_source">
						<a class="source" href="sort.html">src/sort.js</a>
					</li>
				
					
					<li data-source="src/split.js" class="list_source">
						<a class="source" href="split.html">src/split.js</a>
					</li>
				
					
					<li data-source="src/substitute.js" class="list_source">
						<a class="source" href="substitute.html">src/substitute.js</a>
					</li>
				
					
					<li data-source="src/substituteAll.js" class="list_source">
						<a class="source" href="substituteAll.html">src/substituteAll.js</a>
					</li>
				
					
					<li data-source="src/subtract.js" class="list_source">
						<a class="source" href="subtract.html">src/subtract.js</a>
					</li>
				
					
					<li data-source="src/sum.js" class="list_source">
						<a class="source" href="sum.html">src/sum.js</a>
					</li>
				
					
					<li data-source="src/surroundKeys.js" class="list_source">
						<a class="source" href="surroundKeys.html">src/surroundKeys.js</a>
					</li>
				
					
					<li data-source="src/switch.js" class="list_source">
						<a class="source" href="switch.html">src/switch.js</a>
					</li>
				
					
					<li data-source="src/tan.js" class="list_source">
						<a class="source" href="tan.html">src/tan.js</a>
					</li>
				
					
					<li data-source="src/tau.js" class="list_source">
						<a class="source" href="tau.html">src/tau.js</a>
					</li>
				
					
					<li data-source="src/text.js" class="list_source">
						<a class="source" href="text.html">src/text.js</a>
					</li>
				
					
					<li data-source="src/time.js" class="list_source">
						<a class="source" href="time.html">src/time.js</a>
					</li>
				
					
					<li data-source="src/timevalue.js" class="list_source">
						<a class="source" href="timevalue.html">src/timevalue.js</a>
					</li>
				
					
					<li data-source="src/today.js" class="list_source">
						<a class="source" href="today.html">src/today.js</a>
					</li>
				
					
					<li data-source="src/trim.js" class="list_source">
						<a class="source" href="trim.html">src/trim.js</a>
					</li>
				
					
					<li data-source="src/trunc.js" class="list_source">
						<a class="source" href="trunc.html">src/trunc.js</a>
					</li>
				
					
					<li data-source="src/unflatten.js" class="list_source">
						<a class="source" href="unflatten.html">src/unflatten.js</a>
					</li>
				
					
					<li data-source="src/unique.js" class="list_source">
						<a class="source" href="unique.html">src/unique.js</a>
					</li>
				
					
					<li data-source="src/upper.js" class="list_source">
						<a class="source" href="upper.html">src/upper.js</a>
					</li>
				
					
					<li data-source="src/vlookup.js" class="list_source">
						<a class="source" href="vlookup.html">src/vlookup.js</a>
					</li>
				
					
					<li data-source="src/walker.js" class="list_source">
						<a class="source" href="walker.html">src/walker.js</a>
					</li>
				
					
					<li data-source="src/within.js" class="list_source">
						<a class="source" href="within.html">src/within.js</a>
					</li>
				
					
					<li data-source="src/xor.js" class="list_source">
						<a class="source" href="xor.html">src/xor.js</a>
					</li>
				
					
					<li data-source="src/year.js" class="list_source">
						<a class="source" href="year.html">src/year.js</a>
					</li>
				
					
					<li data-source="src/yearfrac.js" class="list_source">
						<a class="source" href="yearfrac.html">src/yearfrac.js</a>
					</li>
				
			</ul>
		</div>
	</div>

	<div id="container">
		<div id="background"></div>
		<ul class="sections">
				
					<li id="title">
							<div class="annotation">
									<h1>text.js</h1>
							</div>
					</li>
				
				
				
				<li id="section-1">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-1">&#182;</a>
							</div>
							<p>Copyright 2015-2021 JC Fisher
based heavily on code from socialcalc</p>

						</div>
						
						<div class="content"><div class='highlight'><pre><span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">import</span> {
  d1900,
  MinutesInHour,
  MinutesInDay,
  SecondsInMinute,
  SecondsInDay,
  SecondsInHour,
  AllowedDates,
  DayNames,
  DayNames3,
  MonthNames,
  MonthNames3,
  AM,
  AM1,
  PM,
  PM1,
  DefaultCurrency,
  SeparatorChar,
  DecimalChar,
  AllowedColors
} <span class="hljs-keyword">from</span> <span class="hljs-string">"./constants"</span>;

<span class="hljs-keyword">import</span> parsedate <span class="hljs-keyword">from</span> <span class="hljs-string">"./parsedate"</span>;

<span class="hljs-keyword">let</span> FormatNumber = {};

FormatNumber.format_definitions = {}; <span class="hljs-comment">// Parsed formats are stored here globally</span></pre></div></div>
						
				</li>
				
				
				<li id="section-2">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-2">&#182;</a>
							</div>
							<p>Other constants</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>
FormatNumber.commands = {
  <span class="hljs-attr">copy</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">integer_placeholder</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">fraction_placeholder</span>: <span class="hljs-number">4</span>,
  <span class="hljs-attr">decimal</span>: <span class="hljs-number">5</span>,
  <span class="hljs-attr">currency</span>: <span class="hljs-number">6</span>,
  <span class="hljs-attr">general</span>: <span class="hljs-number">7</span>,
  <span class="hljs-attr">separator</span>: <span class="hljs-number">8</span>,
  <span class="hljs-attr">date</span>: <span class="hljs-number">9</span>,
  <span class="hljs-attr">comparison</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">section</span>: <span class="hljs-number">11</span>,
  <span class="hljs-attr">style</span>: <span class="hljs-number">12</span>
};

<span class="hljs-comment">/* *******************

result = FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char)

************************* */</span>

FormatNumber.formatNumberWithFormat = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">
  rawvalue,
  format_string,
  currency_char
</span>) </span>{
  <span class="hljs-keyword">var</span> scfn = FormatNumber;

  <span class="hljs-keyword">var</span> op, operandstr, fromend, cval, operandstrlc;
  <span class="hljs-keyword">var</span> startval, estartval;
  <span class="hljs-keyword">var</span> hrs, mins, secs, ehrs, emins, esecs, ampmstr, ymd;
  <span class="hljs-keyword">var</span> minOK, mpos, mspos;
  <span class="hljs-keyword">var</span> result = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> format;
  <span class="hljs-keyword">var</span> section, gotcomparison, compop, compval, cpos, oppos;
  <span class="hljs-keyword">var</span> sectioninfo;
  <span class="hljs-keyword">var</span> i,
    decimalscale,
    scaledvalue,
    strvalue,
    strparts,
    integervalue,
    fractionvalue;
  <span class="hljs-keyword">var</span> integerdigits2,
    integerpos,
    fractionpos,
    textcolor,
    textstyle,
    separatorchar,
    decimalchar;
  <span class="hljs-keyword">var</span> value; <span class="hljs-comment">// working copy to change sign, etc.</span>

  rawvalue = rawvalue - <span class="hljs-number">0</span>; <span class="hljs-comment">// make sure a number</span>
  value = rawvalue;
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isFinite</span>(value)) <span class="hljs-keyword">return</span> <span class="hljs-string">"NaN"</span>;

  <span class="hljs-keyword">var</span> negativevalue = value &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>; <span class="hljs-comment">// determine sign, etc.</span>
  <span class="hljs-keyword">if</span> (negativevalue) value = -value;
  <span class="hljs-keyword">var</span> zerovalue = value == <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;

  currency_char = currency_char || DefaultCurrency;

  FormatNumber.parse_format_string(scfn.format_definitions, format_string); <span class="hljs-comment">// make sure format is parsed</span>
  format = scfn.format_definitions[format_string]; <span class="hljs-comment">// Get format structure</span>

  <span class="hljs-keyword">if</span> (!format) <span class="hljs-keyword">throw</span> <span class="hljs-string">"Format not parsed error."</span>;

  section = format.sectioninfo.length - <span class="hljs-number">1</span>; <span class="hljs-comment">// get number of sections - 1</span></pre></div></div>
						
				</li>
				
				
				<li id="section-3">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-3">&#182;</a>
							</div>
							<p>has comparisons - determine which section</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (format.hascomparison) {
    section = <span class="hljs-number">0</span>; <span class="hljs-comment">// set to which section we will use</span>
    gotcomparison = <span class="hljs-number">0</span>; <span class="hljs-comment">// this section has no comparison</span>
    <span class="hljs-keyword">for</span> (cpos = <span class="hljs-number">0</span>; ; cpos++) {</pre></div></div>
						
				</li>
				
				
				<li id="section-4">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-4">&#182;</a>
							</div>
							<p>scan for comparisons</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      op = format.operators[cpos];
      operandstr = format.operands[cpos]; <span class="hljs-comment">// get next operator and operand</span></pre></div></div>
						
				</li>
				
				
				<li id="section-5">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-5">&#182;</a>
							</div>
							<p>at end with no match</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (!op) {</pre></div></div>
						
				</li>
				
				
				<li id="section-6">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-6">&#182;</a>
							</div>
							<p>if comparison but no match</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (gotcomparison) {
          format_string = <span class="hljs-string">"General"</span>; <span class="hljs-comment">// use default of General</span>
          scfn.parse_format_string(scfn.format_definitions, format_string);
          format = scfn.format_definitions[format_string];
          section = <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">break</span>; <span class="hljs-comment">// if no comparision, matches on this section</span>
      }</pre></div></div>
						
				</li>
				
				
				<li id="section-7">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-7">&#182;</a>
							</div>
							<p>end of section</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (op == scfn.commands.section) {
        <span class="hljs-keyword">if</span> (!gotcomparison) {</pre></div></div>
						
				</li>
				
				
				<li id="section-8">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-8">&#182;</a>
							</div>
							<p>no comparison, so it’s a match</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">break</span>;
        }
        gotcomparison = <span class="hljs-number">0</span>;
        section++; <span class="hljs-comment">// check out next one</span>
        <span class="hljs-keyword">continue</span>;
      }</pre></div></div>
						
				</li>
				
				
				<li id="section-9">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-9">&#182;</a>
							</div>
							<p>found a comparison - do we meet it?</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (op == scfn.commands.comparison) {
        i = operandstr.indexOf(<span class="hljs-string">":"</span>);
        compop = operandstr.substring(<span class="hljs-number">0</span>, i);
        compval = operandstr.substring(i + <span class="hljs-number">1</span>) - <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (
          (compop == <span class="hljs-string">"&lt;"</span> &amp;&amp; rawvalue &lt; compval) ||
          (compop == <span class="hljs-string">"&lt;="</span> &amp;&amp; rawvalue &lt;= compval) ||
          (compop == <span class="hljs-string">"="</span> &amp;&amp; rawvalue == compval) ||
          (compop == <span class="hljs-string">"&lt;&gt;"</span> &amp;&amp; rawvalue != compval) ||
          (compop == <span class="hljs-string">"&gt;="</span> &amp;&amp; rawvalue &gt;= compval) ||
          (compop == <span class="hljs-string">"&gt;"</span> &amp;&amp; rawvalue &gt; compval)
        ) {
          <span class="hljs-keyword">break</span>;
        }
        gotcomparison = <span class="hljs-number">1</span>;
      }
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (section &gt; <span class="hljs-number">0</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-10">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-10">&#182;</a>
							</div>
							<p>more than one section (separated by “;”)
two sections</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (section == <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">if</span> (negativevalue) {
        negativevalue = <span class="hljs-number">0</span>; <span class="hljs-comment">// sign will provided by section, not automatically</span>
        section = <span class="hljs-number">1</span>; <span class="hljs-comment">// use second section for negative values</span>
      } <span class="hljs-keyword">else</span> {
        section = <span class="hljs-number">0</span>; <span class="hljs-comment">// use first for all others</span>
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (section == <span class="hljs-number">2</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-11">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-11">&#182;</a>
							</div>
							<p>three sections</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (negativevalue) {
        negativevalue = <span class="hljs-number">0</span>; <span class="hljs-comment">// sign will provided by section, not automatically</span>
        section = <span class="hljs-number">1</span>; <span class="hljs-comment">// use second section for negative values</span>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (zerovalue) {
        section = <span class="hljs-number">2</span>; <span class="hljs-comment">// use third section for zero values</span>
      } <span class="hljs-keyword">else</span> {
        section = <span class="hljs-number">0</span>; <span class="hljs-comment">// use first for positive</span>
      }
    }
  }

  sectioninfo = format.sectioninfo[section]; <span class="hljs-comment">// look at values for our section</span>

  <span class="hljs-keyword">if</span> (sectioninfo.commas &gt; <span class="hljs-number">0</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-12">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-12">&#182;</a>
							</div>
							<p>scale by thousands</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; sectioninfo.commas; i++) {
      value /= <span class="hljs-number">1000</span>;
    }
  }
  <span class="hljs-keyword">if</span> (sectioninfo.percent &gt; <span class="hljs-number">0</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-13">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-13">&#182;</a>
							</div>
							<p>do percent scaling</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; sectioninfo.percent; i++) {
      value *= <span class="hljs-number">100</span>;
    }
  }

  decimalscale = <span class="hljs-number">1</span>; <span class="hljs-comment">// cut down to required number of decimal digits</span>
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; sectioninfo.fractiondigits; i++) {
    decimalscale *= <span class="hljs-number">10</span>;
  }
  scaledvalue = <span class="hljs-built_in">Math</span>.floor(value * decimalscale + <span class="hljs-number">0.5</span>);
  scaledvalue = scaledvalue / decimalscale;

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> scaledvalue != <span class="hljs-string">"number"</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"NaN"</span>;
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isFinite</span>(scaledvalue)) <span class="hljs-keyword">return</span> <span class="hljs-string">"NaN"</span>;

  strvalue = scaledvalue + <span class="hljs-string">""</span>; <span class="hljs-comment">// convert to string (Number.toFixed doesn't do all we need)</span></pre></div></div>
						
				</li>
				
				
				<li id="section-14">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-14">&#182;</a>
							</div>
							<p>  strvalue = value.toFixed(sectioninfo.fractiondigits); // cut down to required number of decimal digits
and convert to string</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">if</span> (
    scaledvalue == <span class="hljs-number">0</span> &amp;&amp;
    (sectioninfo.fractiondigits || sectioninfo.integerdigits)
  ) {
    negativevalue = <span class="hljs-number">0</span>; <span class="hljs-comment">// no "-0" unless using multiple sections or General</span>
  }</pre></div></div>
						
				</li>
				
				
				<li id="section-15">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-15">&#182;</a>
							</div>
							<p>converted to scientific notation</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (strvalue.indexOf(<span class="hljs-string">"e"</span>) &gt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> rawvalue + <span class="hljs-string">""</span>; <span class="hljs-comment">// Just return plain converted raw value</span>
  }

  strparts = strvalue.match(<span class="hljs-regexp">/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/</span>); <span class="hljs-comment">// get integer and fraction parts</span>
  <span class="hljs-keyword">if</span> (!strparts) <span class="hljs-keyword">return</span> <span class="hljs-string">"NaN"</span>; <span class="hljs-comment">// if not a number</span>
  integervalue = strparts[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">if</span> (!integervalue || integervalue == <span class="hljs-string">"0"</span>) integervalue = <span class="hljs-string">""</span>;
  fractionvalue = strparts[<span class="hljs-number">2</span>];
  <span class="hljs-keyword">if</span> (!fractionvalue) fractionvalue = <span class="hljs-string">""</span>;</pre></div></div>
						
				</li>
				
				
				<li id="section-16">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-16">&#182;</a>
							</div>
							<p>there are date placeholders</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (sectioninfo.hasdate) {</pre></div></div>
						
				</li>
				
				
				<li id="section-17">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-17">&#182;</a>
							</div>
							<p>bad date</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (rawvalue &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">"??-???-?? ??:??:??"</span>;
    }
    startval = (rawvalue - <span class="hljs-built_in">Math</span>.floor(rawvalue)) * SecondsInDay; <span class="hljs-comment">// get date/time parts</span>
    estartval = rawvalue * SecondsInDay; <span class="hljs-comment">// do elapsed time version, too</span>
    hrs = <span class="hljs-built_in">Math</span>.floor(startval / SecondsInHour);
    ehrs = <span class="hljs-built_in">Math</span>.floor(estartval / SecondsInHour);
    startval = startval - hrs * SecondsInHour;
    mins = <span class="hljs-built_in">Math</span>.floor(startval / <span class="hljs-number">60</span>);
    emins = <span class="hljs-built_in">Math</span>.floor(estartval / <span class="hljs-number">60</span>);
    secs = startval - mins * <span class="hljs-number">60</span>;
    decimalscale = <span class="hljs-number">1</span>; <span class="hljs-comment">// round appropriately depending if there is ss.0</span>
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; sectioninfo.fractiondigits; i++) {
      decimalscale *= <span class="hljs-number">10</span>;
    }
    secs = <span class="hljs-built_in">Math</span>.floor(secs * decimalscale + <span class="hljs-number">0.5</span>);
    secs = secs / decimalscale;
    esecs = <span class="hljs-built_in">Math</span>.floor(estartval * decimalscale + <span class="hljs-number">0.5</span>);
    esecs = esecs / decimalscale;
    <span class="hljs-keyword">if</span> (secs &gt;= <span class="hljs-number">60</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-18">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-18">&#182;</a>
							</div>
							<p>handle round up into next second, minute, etc.</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      secs = <span class="hljs-number">0</span>;
      mins++;
      emins++;
      <span class="hljs-keyword">if</span> (mins &gt;= <span class="hljs-number">60</span>) {
        mins = <span class="hljs-number">0</span>;
        hrs++;
        ehrs++;
        <span class="hljs-keyword">if</span> (hrs &gt;= <span class="hljs-number">24</span>) {
          hrs = <span class="hljs-number">0</span>;
          rawvalue++;
        }
      }
    }
    fractionvalue = secs - <span class="hljs-built_in">Math</span>.floor(secs) + <span class="hljs-string">""</span>; <span class="hljs-comment">// for "hh:mm:ss.000"</span>
    fractionvalue = fractionvalue.substring(<span class="hljs-number">2</span>); <span class="hljs-comment">// skip "0."</span>

    ymd = parsedate(rawvalue);
    ymd = {
      <span class="hljs-attr">year</span>: ymd.getFullYear(),
      <span class="hljs-attr">month</span>: ymd.getMonth() + <span class="hljs-number">1</span>,
      <span class="hljs-attr">day</span>: ymd.getDate()
    };

    minOK = <span class="hljs-number">0</span>; <span class="hljs-comment">// says "m" can be minutes if true</span>
    mspos = sectioninfo.sectionstart; <span class="hljs-comment">// m scan position in ops</span>
    <span class="hljs-keyword">for</span> (; ; mspos++) {</pre></div></div>
						
				</li>
				
				
				<li id="section-19">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-19">&#182;</a>
							</div>
							<p>scan for “m” and “mm” to see if any minutes fields, and am/pm</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      op = format.operators[mspos];
      operandstr = format.operands[mspos]; <span class="hljs-comment">// get next operator and operand</span>
      <span class="hljs-keyword">if</span> (!op) <span class="hljs-keyword">break</span>; <span class="hljs-comment">// don't go past end</span>
      <span class="hljs-keyword">if</span> (op == scfn.commands.section) <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">if</span> (op == scfn.commands.date) {
        <span class="hljs-keyword">if</span> (
          (operandstr.toLowerCase() == <span class="hljs-string">"am/pm"</span> ||
            operandstr.toLowerCase() == <span class="hljs-string">"a/p"</span>) &amp;&amp;
          !ampmstr
        ) {
          <span class="hljs-keyword">if</span> (hrs &gt;= <span class="hljs-number">12</span>) {
            <span class="hljs-keyword">if</span> (hrs &gt; <span class="hljs-number">12</span>) hrs -= <span class="hljs-number">12</span>;
            ampmstr = operandstr.toLowerCase() == <span class="hljs-string">"a/p"</span> ? PM1 : PM; <span class="hljs-comment">// "P" : "PM";</span>
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (hrs === <span class="hljs-number">0</span>) hrs = <span class="hljs-number">12</span>;
            ampmstr = operandstr.toLowerCase() == <span class="hljs-string">"a/p"</span> ? AM1 : AM; <span class="hljs-comment">// "A" : "AM";</span>
          }
          <span class="hljs-keyword">if</span> (operandstr.indexOf(ampmstr) &lt; <span class="hljs-number">0</span>) ampmstr = ampmstr.toLowerCase(); <span class="hljs-comment">// have case match case in format</span>
        }
        <span class="hljs-keyword">if</span> (minOK &amp;&amp; (operandstr == <span class="hljs-string">"m"</span> || operandstr == <span class="hljs-string">"mm"</span>)) {
          format.operands[mspos] += <span class="hljs-string">"in"</span>; <span class="hljs-comment">// turn into "min" or "mmin"</span>
        }
        <span class="hljs-keyword">if</span> (operandstr.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">"h"</span>) {
          minOK = <span class="hljs-number">1</span>; <span class="hljs-comment">// m following h or hh or [h] is minutes not months</span>
        } <span class="hljs-keyword">else</span> {
          minOK = <span class="hljs-number">0</span>;
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op != scfn.commands.copy) {</pre></div></div>
						
				</li>
				
				
				<li id="section-20">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-20">&#182;</a>
							</div>
							<p>copying chars can be between h and m</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        minOK = <span class="hljs-number">0</span>;
      }
    }
    minOK = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (--mspos; ; mspos--) {</pre></div></div>
						
				</li>
				
				
				<li id="section-21">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-21">&#182;</a>
							</div>
							<p>scan other way for s after m</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      op = format.operators[mspos];
      operandstr = format.operands[mspos]; <span class="hljs-comment">// get next operator and operand</span>
      <span class="hljs-keyword">if</span> (!op) <span class="hljs-keyword">break</span>; <span class="hljs-comment">// don't go past end</span>
      <span class="hljs-keyword">if</span> (op == scfn.commands.section) <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">if</span> (op == scfn.commands.date) {
        <span class="hljs-keyword">if</span> (minOK &amp;&amp; (operandstr == <span class="hljs-string">"m"</span> || operandstr == <span class="hljs-string">"mm"</span>)) {
          format.operands[mspos] += <span class="hljs-string">"in"</span>; <span class="hljs-comment">// turn into "min" or "mmin"</span>
        }
        <span class="hljs-keyword">if</span> (operandstr == <span class="hljs-string">"ss"</span>) {
          minOK = <span class="hljs-number">1</span>; <span class="hljs-comment">// m before ss is minutes not months</span>
        } <span class="hljs-keyword">else</span> {
          minOK = <span class="hljs-number">0</span>;
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op != scfn.commands.copy) {</pre></div></div>
						
				</li>
				
				
				<li id="section-22">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-22">&#182;</a>
							</div>
							<p>copying chars can be between ss and m</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        minOK = <span class="hljs-number">0</span>;
      }
    }
  }

  integerdigits2 = <span class="hljs-number">0</span>; <span class="hljs-comment">// init counters, etc.</span>
  integerpos = <span class="hljs-number">0</span>;
  fractionpos = <span class="hljs-number">0</span>;
  textcolor = <span class="hljs-string">""</span>;
  textstyle = <span class="hljs-string">""</span>;
  separatorchar = SeparatorChar;
  <span class="hljs-keyword">if</span> (separatorchar.indexOf(<span class="hljs-string">" "</span>) &gt;= <span class="hljs-number">0</span>)
    separatorchar = separatorchar.replace(<span class="hljs-regexp">/ /g</span>, <span class="hljs-string">" "</span>);
  decimalchar = DecimalChar;
  <span class="hljs-keyword">if</span> (decimalchar.indexOf(<span class="hljs-string">" "</span>) &gt;= <span class="hljs-number">0</span>)
    decimalchar = decimalchar.replace(<span class="hljs-regexp">/ /g</span>, <span class="hljs-string">" "</span>);

  oppos = sectioninfo.sectionstart;

  <span class="hljs-keyword">while</span> ((op = format.operators[oppos])) {</pre></div></div>
						
				</li>
				
				
				<li id="section-23">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-23">&#182;</a>
							</div>
							<p>execute format</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    operandstr = format.operands[oppos++]; <span class="hljs-comment">// get next operator and operand</span>

    <span class="hljs-keyword">if</span> (op == scfn.commands.copy) {</pre></div></div>
						
				</li>
				
				
				<li id="section-24">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-24">&#182;</a>
							</div>
							<p>put char in result</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      result += operandstr;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.color) {</pre></div></div>
						
				</li>
				
				
				<li id="section-25">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-25">&#182;</a>
							</div>
							<p>set color</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      textcolor = operandstr;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.style) {</pre></div></div>
						
				</li>
				
				
				<li id="section-26">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-26">&#182;</a>
							</div>
							<p>set style</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      textstyle = operandstr;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.integer_placeholder) {</pre></div></div>
						
				</li>
				
				
				<li id="section-27">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-27">&#182;</a>
							</div>
							<p>insert number part</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (negativevalue) {
        result += <span class="hljs-string">"-"</span>;
        negativevalue = <span class="hljs-number">0</span>;
      }
      integerdigits2++;
      <span class="hljs-keyword">if</span> (integerdigits2 == <span class="hljs-number">1</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-28">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-28">&#182;</a>
							</div>
							<p>first one</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (integervalue.length &gt; sectioninfo.integerdigits) {</pre></div></div>
						
				</li>
				
				
				<li id="section-29">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-29">&#182;</a>
							</div>
							<p>see if integer wider than field</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">for</span> (
            ;
            integerpos &lt; integervalue.length - sectioninfo.integerdigits;
            integerpos++
          ) {
            result += integervalue.charAt(integerpos);
            <span class="hljs-keyword">if</span> (sectioninfo.thousandssep) {</pre></div></div>
						
				</li>
				
				
				<li id="section-30">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-30">&#182;</a>
							</div>
							<p>see if this is a separator position</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>              fromend = integervalue.length - integerpos - <span class="hljs-number">1</span>;
              <span class="hljs-keyword">if</span> (fromend &gt; <span class="hljs-number">2</span> &amp;&amp; fromend % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>) {
                result += separatorchar;
              }
            }
          }
        }
      }
      <span class="hljs-keyword">if</span> (
        integervalue.length &lt; sectioninfo.integerdigits &amp;&amp;
        integerdigits2 &lt;= sectioninfo.integerdigits - integervalue.length
      ) {</pre></div></div>
						
				</li>
				
				
				<li id="section-31">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-31">&#182;</a>
							</div>
							<p>field is wider than value</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (operandstr == <span class="hljs-string">"0"</span> || operandstr == <span class="hljs-string">"?"</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-32">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-32">&#182;</a>
							</div>
							<p>fill with appropriate characters</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>          result += operandstr == <span class="hljs-string">"0"</span> ? <span class="hljs-string">"0"</span> : <span class="hljs-string">" "</span>;
          <span class="hljs-keyword">if</span> (sectioninfo.thousandssep) {</pre></div></div>
						
				</li>
				
				
				<li id="section-33">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-33">&#182;</a>
							</div>
							<p>see if this is a separator position</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>            fromend = sectioninfo.integerdigits - integerdigits2;
            <span class="hljs-keyword">if</span> (fromend &gt; <span class="hljs-number">2</span> &amp;&amp; fromend % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>) {
              result += separatorchar;
            }
          }
        }
      } <span class="hljs-keyword">else</span> {</pre></div></div>
						
				</li>
				
				
				<li id="section-34">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-34">&#182;</a>
							</div>
							<p>normal integer digit - add it</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        result += integervalue.charAt(integerpos);
        <span class="hljs-keyword">if</span> (sectioninfo.thousandssep) {</pre></div></div>
						
				</li>
				
				
				<li id="section-35">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-35">&#182;</a>
							</div>
							<p>see if this is a separator position</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>          fromend = integervalue.length - integerpos - <span class="hljs-number">1</span>;
          <span class="hljs-keyword">if</span> (fromend &gt; <span class="hljs-number">2</span> &amp;&amp; fromend % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>) {
            result += separatorchar;
          }
        }
        integerpos++;
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.fraction_placeholder) {</pre></div></div>
						
				</li>
				
				
				<li id="section-36">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-36">&#182;</a>
							</div>
							<p>add fraction part of number</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (fractionpos &gt;= fractionvalue.length) {
        <span class="hljs-keyword">if</span> (operandstr == <span class="hljs-string">"0"</span> || operandstr == <span class="hljs-string">"?"</span>) {
          result += operandstr == <span class="hljs-string">"0"</span> ? <span class="hljs-string">"0"</span> : <span class="hljs-string">" "</span>;
        }
      } <span class="hljs-keyword">else</span> {
        result += fractionvalue.charAt(fractionpos);
      }
      fractionpos++;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.decimal) {</pre></div></div>
						
				</li>
				
				
				<li id="section-37">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-37">&#182;</a>
							</div>
							<p>decimal point</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (negativevalue) {
        result += <span class="hljs-string">"-"</span>;
        negativevalue = <span class="hljs-number">0</span>;
      }
      result += decimalchar;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.currency) {</pre></div></div>
						
				</li>
				
				
				<li id="section-38">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-38">&#182;</a>
							</div>
							<p>currency symbol</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (negativevalue) {
        result += <span class="hljs-string">"-"</span>;
        negativevalue = <span class="hljs-number">0</span>;
      }
      result += operandstr;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.general) {</pre></div></div>
						
				</li>
				
				
				<li id="section-39">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-39">&#182;</a>
							</div>
							<p>insert “General” conversion</p>

						</div>
						
				</li>
				
				
				<li id="section-40">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-40">&#182;</a>
							</div>
							<p>*** Cut down number of significant digits to avoid floating point artifacts:</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>
      <span class="hljs-keyword">if</span> (value != <span class="hljs-number">0</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-41">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-41">&#182;</a>
							</div>
							<p>only if non-zero</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> factor = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.LOG10E * <span class="hljs-built_in">Math</span>.log(value)); <span class="hljs-comment">// get integer magnitude as a power of 10</span>
        factor = <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">10</span>, <span class="hljs-number">13</span> - factor); <span class="hljs-comment">// turn into scaling factor</span>
        value = <span class="hljs-built_in">Math</span>.floor(factor * value + <span class="hljs-number">0.5</span>) / factor; <span class="hljs-comment">// scale positive value, round, undo scaling</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isFinite</span>(value)) <span class="hljs-keyword">return</span> <span class="hljs-string">"NaN"</span>;
      }
      <span class="hljs-keyword">if</span> (negativevalue) {
        result += <span class="hljs-string">"-"</span>;
      }
      strvalue = value + <span class="hljs-string">""</span>; <span class="hljs-comment">// convert original value to string</span>
      <span class="hljs-keyword">if</span> (strvalue.indexOf(<span class="hljs-string">"e"</span>) &gt;= <span class="hljs-number">0</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-42">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-42">&#182;</a>
							</div>
							<p>converted to scientific notation</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        result += strvalue;
        <span class="hljs-keyword">continue</span>;
      }
      strparts = strvalue.match(<span class="hljs-regexp">/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/</span>); <span class="hljs-comment">// get integer and fraction parts</span>
      integervalue = strparts[<span class="hljs-number">1</span>];
      <span class="hljs-keyword">if</span> (!integervalue || integervalue == <span class="hljs-string">"0"</span>) integervalue = <span class="hljs-string">""</span>;
      fractionvalue = strparts[<span class="hljs-number">2</span>];
      <span class="hljs-keyword">if</span> (!fractionvalue) fractionvalue = <span class="hljs-string">""</span>;
      integerpos = <span class="hljs-number">0</span>;
      fractionpos = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (integervalue.length) {
        <span class="hljs-keyword">for</span> (; integerpos &lt; integervalue.length; integerpos++) {
          result += integervalue.charAt(integerpos);
          <span class="hljs-keyword">if</span> (sectioninfo.thousandssep) {</pre></div></div>
						
				</li>
				
				
				<li id="section-43">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-43">&#182;</a>
							</div>
							<p>see if this is a separator position</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>            fromend = integervalue.length - integerpos - <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span> (fromend &gt; <span class="hljs-number">2</span> &amp;&amp; fromend % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>) {
              result += separatorchar;
            }
          }
        }
      } <span class="hljs-keyword">else</span> {
        result += <span class="hljs-string">"0"</span>;
      }
      <span class="hljs-keyword">if</span> (fractionvalue.length) {
        result += decimalchar;
        <span class="hljs-keyword">for</span> (; fractionpos &lt; fractionvalue.length; fractionpos++) {
          result += fractionvalue.charAt(fractionpos);
        }
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.date) {</pre></div></div>
						
				</li>
				
				
				<li id="section-44">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-44">&#182;</a>
							</div>
							<p>date placeholder</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      operandstrlc = operandstr.toLowerCase();
      <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"y"</span> || operandstrlc == <span class="hljs-string">"yy"</span>) {
        result += (ymd.year + <span class="hljs-string">""</span>).substring(<span class="hljs-number">2</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"yyyy"</span>) {
        result += ymd.year + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"d"</span>) {
        result += ymd.day + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"dd"</span>) {
        cval = <span class="hljs-number">1000</span> + ymd.day;
        result += (cval + <span class="hljs-string">""</span>).substr(<span class="hljs-number">2</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"ddd"</span>) {
        cval = <span class="hljs-built_in">Math</span>.floor(rawvalue + <span class="hljs-number">6</span>) % <span class="hljs-number">7</span>;
        result += DayNames3[cval];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"dddd"</span>) {
        cval = <span class="hljs-built_in">Math</span>.floor(rawvalue + <span class="hljs-number">6</span>) % <span class="hljs-number">7</span>;
        result += DayNames[cval];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"m"</span>) {
        result += ymd.month + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"mm"</span>) {
        cval = <span class="hljs-number">1000</span> + ymd.month;
        result += (cval + <span class="hljs-string">""</span>).substr(<span class="hljs-number">2</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"mmm"</span>) {
        result += MonthNames3[ymd.month - <span class="hljs-number">1</span>];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"mmmm"</span>) {
        result += MonthNames[ymd.month - <span class="hljs-number">1</span>];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"mmmmm"</span>) {
        result += MonthNames[ymd.month - <span class="hljs-number">1</span>].charAt(<span class="hljs-number">0</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"h"</span>) {
        result += hrs + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"h]"</span>) {
        result += ehrs + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"mmin"</span>) {
        cval = <span class="hljs-number">1000</span> + mins + <span class="hljs-string">""</span>;
        result += cval.substr(<span class="hljs-number">2</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"mm]"</span>) {
        <span class="hljs-keyword">if</span> (emins &lt; <span class="hljs-number">100</span>) {
          cval = <span class="hljs-number">1000</span> + emins + <span class="hljs-string">""</span>;
          result += cval.substr(<span class="hljs-number">2</span>);
        } <span class="hljs-keyword">else</span> {
          result += emins + <span class="hljs-string">""</span>;
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"min"</span>) {
        result += mins + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"m]"</span>) {
        result += emins + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"hh"</span>) {
        cval = <span class="hljs-number">1000</span> + hrs + <span class="hljs-string">""</span>;
        result += cval.substr(<span class="hljs-number">2</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"s"</span>) {
        cval = <span class="hljs-built_in">Math</span>.floor(secs);
        result += cval + <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"ss"</span>) {
        cval = <span class="hljs-number">1000</span> + <span class="hljs-built_in">Math</span>.floor(secs) + <span class="hljs-string">""</span>;
        result += cval.substr(<span class="hljs-number">2</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"am/pm"</span> || operandstrlc == <span class="hljs-string">"a/p"</span>) {
        result += ampmstr;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (operandstrlc == <span class="hljs-string">"ss]"</span>) {
        <span class="hljs-keyword">if</span> (esecs &lt; <span class="hljs-number">100</span>) {
          cval = <span class="hljs-number">1000</span> + <span class="hljs-built_in">Math</span>.floor(esecs) + <span class="hljs-string">""</span>;
          result += cval.substr(<span class="hljs-number">2</span>);
        } <span class="hljs-keyword">else</span> {
          cval = <span class="hljs-built_in">Math</span>.floor(esecs);
          result += cval + <span class="hljs-string">""</span>;
        }
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.section) {</pre></div></div>
						
				</li>
				
				
				<li id="section-45">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-45">&#182;</a>
							</div>
							<p>end of section</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">break</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == scfn.commands.comparison) {</pre></div></div>
						
				</li>
				
				
				<li id="section-46">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-46">&#182;</a>
							</div>
							<p>ignore</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">continue</span>;
    } <span class="hljs-keyword">else</span> {
      result += <span class="hljs-string">"!! Parse error.!!"</span>;
    }
  }

  <span class="hljs-keyword">if</span> (textcolor) {
    result = <span class="hljs-string">'&lt;span style="color:'</span> + textcolor + <span class="hljs-string">';"&gt;'</span> + result + <span class="hljs-string">"&lt;/span&gt;"</span>;
  }
  <span class="hljs-keyword">if</span> (textstyle) {
    result = <span class="hljs-string">'&lt;span style="'</span> + textstyle + <span class="hljs-string">';"&gt;'</span> + result + <span class="hljs-string">"&lt;/span&gt;"</span>;
  }</pre></div></div>
						
				</li>
				
				
				<li id="section-47">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-47">&#182;</a>
							</div>
							<p>console.log(result)</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">return</span> result;
};

<span class="hljs-comment">/* *******************

FormatNumber.parse_format_string(format_defs, format_string)

Takes a format string (e.g., "#,##0.00_);(#,##0.00)") and fills in format_defs with the parsed info

format_defs
["#,##0.0"]-&gt;{} - elements in the hash are one hash for each format
.operators-&gt;[] - array of operators from parsing the format string (each a number)
.operands-&gt;[] - array of corresponding operators (each usually a string)
.sectioninfo-&gt;[] - one hash for each section of the format
.start
.integerdigits
.fractiondigits
.commas
.percent
.thousandssep
.hasdates
.hascomparison - true if any section has [&lt;100], etc.

************************* */</span>

FormatNumber.parse_format_string = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">format_defs, format_string</span>) </span>{
  <span class="hljs-keyword">var</span> scfn = FormatNumber;

  <span class="hljs-keyword">var</span> format, section, sectioninfo;
  <span class="hljs-keyword">var</span> integerpart = <span class="hljs-number">1</span>; <span class="hljs-comment">// start out in integer part</span>
  <span class="hljs-keyword">var</span> lastwasinteger; <span class="hljs-comment">// last char was an integer placeholder</span>
  <span class="hljs-keyword">var</span> lastwasslash; <span class="hljs-comment">// last char was a backslash - escaping following character</span>
  <span class="hljs-keyword">var</span> lastwasasterisk; <span class="hljs-comment">// repeat next char</span>
  <span class="hljs-keyword">var</span> lastwasunderscore; <span class="hljs-comment">// last char was _ which picks up following char for width</span>
  <span class="hljs-keyword">var</span> inquote, quotestr; <span class="hljs-comment">// processing a quoted string</span>
  <span class="hljs-keyword">var</span> inbracket, bracketstr, bracketdata; <span class="hljs-comment">// processing a bracketed string</span>
  <span class="hljs-keyword">var</span> ingeneral, gpos; <span class="hljs-comment">// checks for characters "General"</span>
  <span class="hljs-keyword">var</span> ampmstr, part; <span class="hljs-comment">// checks for characters "A/P" and "AM/PM"</span>
  <span class="hljs-keyword">var</span> indate; <span class="hljs-comment">// keeps track of date/time placeholders</span>
  <span class="hljs-keyword">var</span> chpos; <span class="hljs-comment">// character position being looked at</span>
  <span class="hljs-keyword">var</span> ch; <span class="hljs-comment">// character being looked at</span>

  <span class="hljs-keyword">if</span> (format_defs[format_string]) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// already defined - nothing to do</span>

  format = { <span class="hljs-attr">operators</span>: [], <span class="hljs-attr">operands</span>: [], <span class="hljs-attr">sectioninfo</span>: [{}] }; <span class="hljs-comment">// create info structure for this format</span>
  format_defs[format_string] = format; <span class="hljs-comment">// add to other format definitions</span>

  section = <span class="hljs-number">0</span>; <span class="hljs-comment">// start with section 0</span>
  sectioninfo = format.sectioninfo[section]; <span class="hljs-comment">// get reference to info for current section</span>
  sectioninfo.sectionstart = <span class="hljs-number">0</span>; <span class="hljs-comment">// position in operands that starts this section</span>
  sectioninfo.integerdigits = <span class="hljs-number">0</span>; <span class="hljs-comment">// number of integer-part placeholders</span>
  sectioninfo.fractiondigits = <span class="hljs-number">0</span>; <span class="hljs-comment">// fraction placeholders</span>
  sectioninfo.commas = <span class="hljs-number">0</span>; <span class="hljs-comment">// commas encountered, to handle scaling</span>
  sectioninfo.percent = <span class="hljs-number">0</span>; <span class="hljs-comment">// times to scale by 100</span>

  <span class="hljs-keyword">for</span> (chpos = <span class="hljs-number">0</span>; chpos &lt; format_string.length; chpos++) {</pre></div></div>
						
				</li>
				
				
				<li id="section-48">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-48">&#182;</a>
							</div>
							<p>parse</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    ch = format_string.charAt(chpos); <span class="hljs-comment">// get next char to examine</span>
    <span class="hljs-keyword">if</span> (inquote) {
      <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">'"'</span>) {
        inquote = <span class="hljs-number">0</span>;
        format.operators.push(scfn.commands.copy);
        format.operands.push(quotestr);
        <span class="hljs-keyword">continue</span>;
      }
      quotestr += ch;
      <span class="hljs-keyword">continue</span>;
    }
    <span class="hljs-keyword">if</span> (inbracket) {
      <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"]"</span>) {
        inbracket = <span class="hljs-number">0</span>;
        bracketdata = FormatNumber.parse_format_bracket(bracketstr);
        <span class="hljs-keyword">if</span> (bracketdata.operator == scfn.commands.separator) {
          sectioninfo.thousandssep = <span class="hljs-number">1</span>; <span class="hljs-comment">// explicit [,]</span>
          <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">if</span> (bracketdata.operator == scfn.commands.date) {
          sectioninfo.hasdate = <span class="hljs-number">1</span>;
        }
        <span class="hljs-keyword">if</span> (bracketdata.operator == scfn.commands.comparison) {
          format.hascomparison = <span class="hljs-number">1</span>;
        }
        format.operators.push(bracketdata.operator);
        format.operands.push(bracketdata.operand);
        <span class="hljs-keyword">continue</span>;
      }
      bracketstr += ch;
      <span class="hljs-keyword">continue</span>;
    }

    <span class="hljs-keyword">if</span> (lastwasslash) {
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch);
      lastwasslash = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">continue</span>;
    }

    <span class="hljs-keyword">if</span> (lastwasasterisk) {
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch + ch + ch + ch + ch); <span class="hljs-comment">// do 5 of them since no real tabs</span>
      lastwasasterisk = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">continue</span>;
    }

    <span class="hljs-keyword">if</span> (lastwasunderscore) {
      format.operators.push(scfn.commands.copy);
      format.operands.push(<span class="hljs-string">" "</span>);
      lastwasunderscore = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">continue</span>;
    }

    <span class="hljs-keyword">if</span> (ingeneral) {
      <span class="hljs-keyword">if</span> (<span class="hljs-string">"general"</span>.charAt(ingeneral) == ch.toLowerCase()) {
        ingeneral++;
        <span class="hljs-keyword">if</span> (ingeneral == <span class="hljs-number">7</span>) {
          format.operators.push(scfn.commands.general);
          format.operands.push(ch);
          ingeneral = <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">continue</span>;
      }
      ingeneral = <span class="hljs-number">0</span>;
    }</pre></div></div>
						
				</li>
				
				
				<li id="section-49">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-49">&#182;</a>
							</div>
							<p>last char was part of a date placeholder</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (indate) {
      <span class="hljs-keyword">if</span> (indate.charAt(<span class="hljs-number">0</span>) == ch) {</pre></div></div>
						
				</li>
				
				
				<li id="section-50">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-50">&#182;</a>
							</div>
							<p>another of the same char</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>        indate += ch; <span class="hljs-comment">// accumulate it</span>
        <span class="hljs-keyword">continue</span>;
      }
      format.operators.push(scfn.commands.date); <span class="hljs-comment">// something else, save date info</span>
      format.operands.push(indate);
      sectioninfo.hasdate = <span class="hljs-number">1</span>;
      indate = <span class="hljs-string">""</span>;
    }
    <span class="hljs-keyword">if</span> (ampmstr) {
      ampmstr += ch;
      part = ampmstr.toLowerCase();
      <span class="hljs-keyword">if</span> (
        part != <span class="hljs-string">"am/pm"</span>.substring(<span class="hljs-number">0</span>, part.length) &amp;&amp;
        part != <span class="hljs-string">"a/p"</span>.substring(<span class="hljs-number">0</span>, part.length)
      ) {
        ampstr = <span class="hljs-string">""</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (part == <span class="hljs-string">"am/pm"</span> || part == <span class="hljs-string">"a/p"</span>) {
        format.operators.push(scfn.commands.date);
        format.operands.push(ampmstr);
        ampmstr = <span class="hljs-string">""</span>;
      }
      <span class="hljs-keyword">continue</span>;
    }
    <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"#"</span> || ch == <span class="hljs-string">"0"</span> || ch == <span class="hljs-string">"?"</span>) {</pre></div></div>
						
				</li>
				
				
				<li id="section-51">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-51">&#182;</a>
							</div>
							<p>placeholder</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (integerpart) {
        sectioninfo.integerdigits++;
        <span class="hljs-keyword">if</span> (sectioninfo.commas) {</pre></div></div>
						
				</li>
				
				
				<li id="section-52">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-52">&#182;</a>
							</div>
							<p>comma inside of integer placeholders</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>          sectioninfo.thousandssep = <span class="hljs-number">1</span>; <span class="hljs-comment">// any number is thousands separator</span>
          sectioninfo.commas = <span class="hljs-number">0</span>; <span class="hljs-comment">// reset count of "thousand" factors</span>
        }
        lastwasinteger = <span class="hljs-number">1</span>;
        format.operators.push(scfn.commands.integer_placeholder);
        format.operands.push(ch);
      } <span class="hljs-keyword">else</span> {
        sectioninfo.fractiondigits++;
        format.operators.push(scfn.commands.fraction_placeholder);
        format.operands.push(ch);
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"."</span>) {
      lastwasinteger = <span class="hljs-number">0</span>;
      format.operators.push(scfn.commands.decimal);
      format.operands.push(ch);
      integerpart = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-string">"$"</span>) {
      lastwasinteger = <span class="hljs-number">0</span>;
      format.operators.push(scfn.commands.currency);
      format.operands.push(ch);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">","</span>) {
      <span class="hljs-keyword">if</span> (lastwasinteger) {
        sectioninfo.commas++;
      } <span class="hljs-keyword">else</span> {
        format.operators.push(scfn.commands.copy);
        format.operands.push(ch);
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"%"</span>) {
      lastwasinteger = <span class="hljs-number">0</span>;
      sectioninfo.percent++;
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">'"'</span>) {
      lastwasinteger = <span class="hljs-number">0</span>;
      inquote = <span class="hljs-number">1</span>;
      quotestr = <span class="hljs-string">""</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"["</span>) {
      lastwasinteger = <span class="hljs-number">0</span>;
      inbracket = <span class="hljs-number">1</span>;
      bracketstr = <span class="hljs-string">""</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"\\"</span>) {
      lastwasslash = <span class="hljs-number">1</span>;
      lastwasinteger = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"*"</span>) {
      lastwasasterisk = <span class="hljs-number">1</span>;
      lastwasinteger = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">"_"</span>) {
      lastwasunderscore = <span class="hljs-number">1</span>;
      lastwasinteger = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">";"</span>) {
      section++; <span class="hljs-comment">// start next section</span>
      format.sectioninfo[section] = {}; <span class="hljs-comment">// create a new section</span>
      sectioninfo = format.sectioninfo[section]; <span class="hljs-comment">// get reference to info for current section</span>
      sectioninfo.sectionstart = <span class="hljs-number">1</span> + format.operators.length; <span class="hljs-comment">// remember where it starts</span>
      sectioninfo.integerdigits = <span class="hljs-number">0</span>; <span class="hljs-comment">// number of integer-part placeholders</span>
      sectioninfo.fractiondigits = <span class="hljs-number">0</span>; <span class="hljs-comment">// fraction placeholders</span>
      sectioninfo.commas = <span class="hljs-number">0</span>; <span class="hljs-comment">// commas encountered, to handle scaling</span>
      sectioninfo.percent = <span class="hljs-number">0</span>; <span class="hljs-comment">// times to scale by 100</span>
      integerpart = <span class="hljs-number">1</span>; <span class="hljs-comment">// reset for new section</span>
      lastwasinteger = <span class="hljs-number">0</span>;
      format.operators.push(scfn.commands.section);
      format.operands.push(ch);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch.toLowerCase() == <span class="hljs-string">"g"</span>) {
      ingeneral = <span class="hljs-number">1</span>;
      lastwasinteger = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch.toLowerCase() == <span class="hljs-string">"a"</span>) {
      ampmstr = ch;
      lastwasinteger = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">"dmyhHs"</span>.indexOf(ch) &gt;= <span class="hljs-number">0</span>) {
      indate = ch;
    } <span class="hljs-keyword">else</span> {
      lastwasinteger = <span class="hljs-number">0</span>;
      format.operators.push(scfn.commands.copy);
      format.operands.push(ch);
    }
  }</pre></div></div>
						
				</li>
				
				
				<li id="section-53">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-53">&#182;</a>
							</div>
							<p>last char was part of unsaved date placeholder</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (indate) {
    format.operators.push(scfn.commands.date);
    format.operands.push(indate);
    sectioninfo.hasdate = <span class="hljs-number">1</span>;
  }

  <span class="hljs-keyword">return</span>;
};

<span class="hljs-comment">/* *******************

bracketdata = FormatNumber.parse_format_bracket(bracketstr)

Takes a bracket contents (e.g., "RED", "&gt;10") and returns an operator and operand

bracketdata-&gt;{}
.operator
.operand

************************* */</span>

FormatNumber.parse_format_bracket = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bracketstr</span>) </span>{
  <span class="hljs-keyword">var</span> scfn = FormatNumber;

  <span class="hljs-keyword">var</span> bracketdata = {};
  <span class="hljs-keyword">var</span> parts;</pre></div></div>
						
				</li>
				
				
				<li id="section-54">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-54">&#182;</a>
							</div>
							<p>currency</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (bracketstr.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">"$"</span>) {
    bracketdata.operator = scfn.commands.currency;
    parts = bracketstr.match(<span class="hljs-regexp">/^\$(.+?)(\-.+?){0,1}$/</span>);
    <span class="hljs-keyword">if</span> (parts) {
      bracketdata.operand = parts[<span class="hljs-number">1</span>] || DefaultCurrency || <span class="hljs-string">"$"</span>;
    } <span class="hljs-keyword">else</span> {
      bracketdata.operand = bracketstr.substring(<span class="hljs-number">1</span>) || DefaultCurrency || <span class="hljs-string">"$"</span>;
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (bracketstr == <span class="hljs-string">"?$"</span>) {
    bracketdata.operator = scfn.commands.currency;
    bracketdata.operand = <span class="hljs-string">"[?$]"</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (AllowedColors[bracketstr.toUpperCase()]) {
    bracketdata.operator = scfn.commands.color;
    bracketdata.operand = AllowedColors[bracketstr.toUpperCase()];
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((parts = bracketstr.match(<span class="hljs-regexp">/^style=([^']*)$/</span>))) {</pre></div></div>
						
				</li>
				
				
				<li id="section-55">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-55">&#182;</a>
							</div>
							<p>[style=…]</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    bracketdata.operator = scfn.commands.style;
    bracketdata.operand = parts[<span class="hljs-number">1</span>];
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (bracketstr == <span class="hljs-string">","</span>) {
    bracketdata.operator = scfn.commands.separator;
    bracketdata.operand = bracketstr;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (AllowedDates[bracketstr.toUpperCase()]) {
    bracketdata.operator = scfn.commands.date;
    bracketdata.operand = AllowedDates[bracketstr.toUpperCase()];
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((parts = bracketstr.match(<span class="hljs-regexp">/^[&lt;&gt;=]/</span>))) {</pre></div></div>
						
				</li>
				
				
				<li id="section-56">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-56">&#182;</a>
							</div>
							<p>comparison operator</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    parts = bracketstr.match(<span class="hljs-regexp">/^([&lt;&gt;=]+)(.+)$/</span>); <span class="hljs-comment">// split operator and value</span>
    bracketdata.operator = scfn.commands.comparison;
    bracketdata.operand = parts[<span class="hljs-number">1</span>] + <span class="hljs-string">":"</span> + parts[<span class="hljs-number">2</span>];
  } <span class="hljs-keyword">else</span> {</pre></div></div>
						
				</li>
				
				
				<li id="section-57">
						<div class="annotation">
							
							<div class="pilwrap ">
								<a class="pilcrow" href="#section-57">&#182;</a>
							</div>
							<p>unknown bracket</p>

						</div>
						
						<div class="content"><div class='highlight'><pre>    bracketdata.operator = scfn.commands.copy;
    bracketdata.operand = <span class="hljs-string">"["</span> + bracketstr + <span class="hljs-string">"]"</span>;
  }

  <span class="hljs-keyword">return</span> bracketdata;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">text</span>(<span class="hljs-params">value, format, currency_char</span>) </span>{
  <span class="hljs-keyword">return</span> FormatNumber.formatNumberWithFormat(value, format, currency_char);
}</pre></div></div>
						
				</li>
				
		</ul>
	</div>
<script>
const search = document.querySelector("#jump_search");
	const list = document.querySelector("#jump_list");
	const items = list.querySelectorAll("li");
	if (search) {
		search.onkeyup = (e) => {
			const value = e.target.value;
			[].map.call(items, elem => elem.classList.remove("found"));
			if (value) {
				const search = "li.list_source[data-source*=\"" + value + "\"]";
				const matches = list.querySelectorAll(search);
				[].map.call(matches, elem => elem.classList.add("found"));
				list.classList.add("searching");
			} else {
				list.classList.remove("searching");
			}
		};
	}
</script>
</body>
</html>
